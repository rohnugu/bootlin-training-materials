% Beamer theme for Bootlin presentations
% Copyright (C) 2010 Maxime Petazzoni <maxime.petazzoni@bulix.org>
% Creative Commons CC-by-sa 3.0

\usepackage{common}
\usepackage[absolute,verbose,overlay]{textpos}
\usepackage{fancyvrb,xcolor}
\setlength{\TPHorizModule}{\paperwidth}
\setlength{\TPVertModule}{\paperheight}
\usepackage{array}

\usetheme{default}
\useinnertheme{default}
\useoutertheme{default}
\usecolortheme{beaver}

\usepackage{pifont} % to use \ding
\usepackage{fontspec}
%\setmainfont{Latin Modern Roman}
%\setsansfont{Latin Modern Sans}
%\setmonofont{Inconsolata}

\usepackage{xeCJK}
\setmainfont{Noto Serif}
\setsansfont{Noto Sans}
\setmonofont{Noto Sans Mono}
\setCJKmainfont{Noto Serif CJK KR}
\setCJKsansfont{Noto Sans CJK KR}
\setCJKmonofont{Noto Sans Mono CJK KR}
\xeCJKsetup{%
CJKspace=true,% % true이면 띄어쓰기 사용. 중국어, 일어는 필요 없을수도
CJKmath=true,%  % true면 math environment 안에서 CJK 글자 사용
CJKecglue={}%   % Western과 CJK 사이의 공백 지정: {}로 간격을 없앰
}

\definecolor{crimsonKU}{RGB}{134,38,51} % PANTONE 202 C

\setbeamercolor*{palette primary}{bg=white}
\definecolor{blorange}{rgb}{0.96,0.5,0.1}

\definecolor{blcode}{rgb}{0.35,0.35,0.35}
\setbeamercolor{code}{fg=blcode}

\fvset{formatcom=\color{blcode}}
\renewcommand\verbatim@font{\normalfont\ttfamily\color{blcode}}

\definecolor{blcodebg}{rgb}{0.9,0.9,0.9}
\setbeamercolor{block body}{bg=blcodebg}

\setbeamerfont{block title}{size=\scriptsize}

\definecolor{bldarkblue}{rgb}{0.25,0.25,0.75}
\setbeamercolor{darkblue}{fg=bldarkblue}
\hypersetup{colorlinks,linkcolor=,urlcolor=bldarkblue}

\setbeamertemplate{blocks}[rounded][shadow=false]

\setbeamercolor{itemize item}{fg=blorange}
\setbeamercolor{itemize subitem}{fg=blorange}
\setbeamercolor{itemize subsubitem}{fg=blorange}
\setbeamertemplate{itemize subitem}[circle]
\setbeamertemplate{itemize subsubitem}[circle]
\setbeamercolor{enumerate item}{fg=blorange}
\setbeamercolor{enumerate subitem}{fg=blorange}
\setbeamercolor{enumerate subsubitem}{fg=blorange}

\setbeamerfont{itemize/enumerate body}{family=\sffamily, size=\small}
\setbeamerfont{itemize/enumerate subbody}{family=\sffamily, size=\footnotesize}
\setbeamerfont{itemize/enumerate subsubbody}{family=\sffamily, size=\scriptsize}
\setbeamerfont{itemize/enumerate subsubsubbody}{family=\sffamily, size=\tiny}


% Custom Bootlin commands
\newcommand{\codecolor}{\usebeamercolor[fg]{code}}
\newcommand{\code}[1]{{\codecolor \path{#1}}}
\newcommand{\codelink}[1]{{\usebeamercolor[fg]{darkblue} \path{#1}}}
\newcommand{\codewithhash}[1]{{\codecolor \tt{#1}}}

\usepackage{listings}
\usepackage{environ}
\usepackage{minted}
\usepackage{setspace}
\usepackage{etoolbox}
\usepackage{makecell}

% Display straight quotes instead of curly ones in verbatim mode
\usepackage{upquote}

\usepackage{ifthen}

\lstloadlanguages{C}
\lstset{%
  basicstyle=\tiny \ttfamily,
  emphstyle=\color{blue}\bfseries\ttfamily,
}

\lstnewenvironment{codeblock}
 {\begin{block}{}}
 {\end{block}}

%% Mode presentation
\mode<presentation>

% Remove navigation symbols
\setbeamertemplate{navigation symbols}{}

\defbeamertemplate*{frametitle}{DNSLabtheme}
{
  \vskip-2pt
  \hbox{%
    \begin{beamercolorbox}[wd=\paperwidth,ht=3ex,dp=1.5ex]{frametitle}%
      \usebeamerfont{frametitle}
      \begin{textblock}{.2}[0.5,0.5](0.12,0.08)
       \includegraphics[width=0.8cm]{common/logo-koreauniv-symbol.pdf}
      \end{textblock}
      \hspace{1.25cm}
      \insertframetitle
    \end{beamercolorbox}
  }
  \vskip-1em\vskip2pt
  \hbox{\hskip-1cm\color{blorange}\vrule width \paperwidth height 1pt}%
}

% Footer
\defbeamertemplate*{footline}{DNSLabtheme}
{
  \hbox{\color{crimsonKU}\vrule width \paperwidth height 0.1pt \vspace{0.1cm}}
  \hbox{%
    \begin{beamercolorbox}[wd=\paperwidth,ht=2.25ex,dp=1ex,leftskip=0.5em]{palette primary}%
      \begin{tabular*}{\textwidth}[t]{@{\extracolsep{\fill}} llr}
        \includegraphics[width=0.07\textwidth]{common/koreauniv-logo.pdf} & 
        Defensible Networked Systems Laboratory (DNSLab) ~{\tt https://dnslab.korea.ac.kr} & \insertframenumber{}/\inserttotalframenumber{}
      \end{tabular*}
    \end{beamercolorbox}
  }
  \vskip0pt
}

\newcommand\tinyv{\@setfontsize\tinyv{4pt}{6}}

\newcommand\titleframe
{
  \begin{frame}[c]{DNSLab Lecture Notes Series}
    \begin{columns}[b]
      \column{0.7\textwidth}
      \Large
      \trainingtitle{}\\
      \vspace{3em}
      \scriptsize
      Latest update: \lastupdateen{}.\\
      \vspace{1em}
      Document updates and training details for the original slides: \url{https://www.bootlin.com}\\
      \vspace{1em}
      Corrections, suggestions, contributions and translations are welcome!\\
      Send them to \href{mailto:hjroh@korea.ac.kr}{hjroh@korea.ac.kr}\\
      \vspace{1em}
      © Copyright 2004-\the\year, Bootlin. Creative Commons BY-SA 3.0 license.\\
      © Copyright 2023-\the\year, Heejun Roh (노희준).\\
      \column{0.3\textwidth}
      \begin{center}
        \includegraphics[height=4cm]{common/koreauniv-logo-square.pdf}
      \end{center}
    \end{columns}
  \end{frame}
}

\AtBeginSection[]
{
  \begin{frame}[c]{\insertsectionhead}
    \begin{columns}[b]
      \column{0.5\textwidth}
      \huge
      \insertsection\\
      \vspace{1.5cm}
      \scriptsize
      \vspace{1cm}
      © Copyright 2004-\the\year, Bootlin. Creative Commons BY-SA 3.0 license.\\
      © Copyright 2023-\the\year, Heejun Roh.\\
      \column{0.5\textwidth}
      \begin{center}
        \includegraphics[scale=0.45]{common/koreauniv-logo-square.pdf}
      \end{center}
    \end{columns}
  \end{frame}
}

\AtBeginSubsection[]
{
  \begin{frame}{\insertsectionhead}
    \huge
    \begin{center}
      \insertsubsection
    \end{center}
  \end{frame}
}

\newcommand\todo[1]{
  {\large \color{red}TODO: #1}
}

\usemintedstyle{perldoc}

%% Create a slide announcing a lab, with the beautiful worker penguin
%% on the left.
%%  first argument: slide title (will be prepended by 'Practical lab - ')
%%  second argument: contents of the slide
\newcommand\setuplabframe[2]{
  \begin{frame}{Practical lab - #1}
    \begin{columns}
      \column{0.4\textwidth}
      \includegraphics[width=\textwidth]{common/lab-penguins.pdf}
      \column{0.6\textwidth}
      #2
      \end{columns}
  \end{frame}
}
